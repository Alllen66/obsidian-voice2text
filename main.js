/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => Voice2TextPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/components/AudioRecorder.ts
var AudioRecorder = class {
  constructor() {
    this.mediaRecorder = null;
    this.audioChunks = [];
    this.isRecording = false;
    this.isPaused = false;
    this.stream = null;
  }
  async startRecording() {
    try {
      this.stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      this.mediaRecorder = new MediaRecorder(this.stream);
      this.mediaRecorder.ondataavailable = (event) => {
        this.audioChunks.push(event.data);
      };
      this.mediaRecorder.start();
      this.isRecording = true;
    } catch (error) {
      throw new Error("\u65E0\u6CD5\u8BBF\u95EE\u9EA6\u514B\u98CE");
    }
  }
  pauseRecording() {
    if (this.mediaRecorder && this.isRecording) {
      this.mediaRecorder.pause();
      this.isPaused = true;
    }
  }
  resumeRecording() {
    if (this.mediaRecorder && this.isPaused) {
      this.mediaRecorder.resume();
      this.isPaused = false;
    }
  }
  async stopRecording() {
    return new Promise((resolve) => {
      if (this.mediaRecorder) {
        this.mediaRecorder.onstop = () => {
          const audioBlob = new Blob(this.audioChunks, { type: "audio/wav" });
          this.audioChunks = [];
          resolve(audioBlob);
        };
        this.mediaRecorder.stop();
        this.isRecording = false;
      }
    });
  }
  getStream() {
    return this.stream;
  }
  cleanup() {
    if (this.mediaRecorder) {
      if (this.isRecording) {
        this.mediaRecorder.stop();
      }
      this.mediaRecorder = null;
    }
    if (this.stream) {
      this.stream.getTracks().forEach((track) => track.stop());
      this.stream = null;
    }
    this.audioChunks = [];
    this.isRecording = false;
    this.isPaused = false;
  }
};

// src/components/TranscriptionService.ts
var TranscriptionService = class {
  constructor(apiKey = "") {
    this.apiKey = apiKey;
    this.apiEndpoint = "https://api.openai.com/v1/audio/transcriptions";
  }
  setApiKey(key) {
    this.apiKey = key;
  }
  getApiKey() {
    return this.apiKey;
  }
  async transcribe(audioBlob) {
    if (!this.apiKey) {
      throw new Error("\u8BF7\u5148\u5728\u8BBE\u7F6E\u4E2D\u914D\u7F6E OpenAI API Key");
    }
    const formData = new FormData();
    formData.append("file", audioBlob, "audio.wav");
    formData.append("model", "whisper-1");
    formData.append("language", "zh");
    formData.append("response_format", "json");
    formData.append("temperature", "0");
    try {
      const response = await fetch(this.apiEndpoint, {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${this.apiKey}`
        },
        body: formData
      });
      if (!response.ok) {
        throw new Error("\u8F6C\u5199\u8BF7\u6C42\u5931\u8D25: " + response.status);
      }
      const data = await response.json();
      return data.text;
    } catch (error) {
      throw new Error("\u8BED\u97F3\u8F6C\u5199\u5931\u8D25: " + error.message);
    }
  }
};

// src/components/SettingsTab.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  openaiApiKey: "",
  saveAudio: true,
  audioFolder: "recordings"
};
var Voice2TextSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin, settings) {
    super(app, plugin);
    this.plugin = plugin;
    this.settings = settings;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "\u8BED\u97F3\u8F6C\u6587\u5B57\u8BBE\u7F6E" });
    new import_obsidian.Setting(containerEl).setName("OpenAI API Key").setDesc("\u8BF7\u8F93\u5165\u60A8\u7684 OpenAI API Key").addText((text) => text.setPlaceholder("\u8F93\u5165\u60A8\u7684 API Key").setValue(this.settings.openaiApiKey).onChange(async (value) => {
      this.settings.openaiApiKey = value;
      await this.plugin.saveData(this.settings);
      this.plugin.transcriptionService.setApiKey(value);
    }));
    new import_obsidian.Setting(containerEl).setName("\u4FDD\u5B58\u97F3\u9891\u6587\u4EF6").setDesc("\u662F\u5426\u4FDD\u5B58\u5F55\u97F3\u6587\u4EF6\u5230\u6587\u6863\u5E93").addToggle((toggle) => toggle.setValue(this.settings.saveAudio).onChange(async (value) => {
      this.settings.saveAudio = value;
      await this.plugin.saveData(this.settings);
    }));
    new import_obsidian.Setting(containerEl).setName("\u97F3\u9891\u6587\u4EF6\u4FDD\u5B58\u8DEF\u5F84").setDesc("\u8BBE\u7F6E\u5F55\u97F3\u6587\u4EF6\u7684\u4FDD\u5B58\u8DEF\u5F84\uFF0C\u9ED8\u8BA4\u4E3A recordings \u6587\u4EF6\u5939").addText((text) => text.setPlaceholder("\u8F93\u5165\u4FDD\u5B58\u8DEF\u5F84").setValue(this.settings.audioFolder).onChange(async (value) => {
      this.settings.audioFolder = value;
      await this.plugin.saveData(this.settings);
    }));
  }
};

// src/components/RecordingModal.ts
var import_obsidian2 = require("obsidian");
var AudioVisualizer = class {
  constructor(canvas) {
    this.canvas = canvas;
    this.animationId = null;
    this.isPaused = false;
    this.audioContext = new AudioContext();
    this.analyser = this.audioContext.createAnalyser();
    this.analyser.fftSize = 256;
    this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);
  }
  connectStream(stream) {
    const source = this.audioContext.createMediaStreamSource(stream);
    source.connect(this.analyser);
    this.startVisualization();
  }
  startVisualization() {
    const draw = () => {
      if (this.isPaused) {
        this.animationId = requestAnimationFrame(draw);
        return;
      }
      this.analyser.getByteFrequencyData(this.dataArray);
      const width = this.canvas.width;
      const height = this.canvas.height;
      const ctx = this.canvas.getContext("2d");
      if (!ctx)
        return;
      ctx.fillStyle = "#1a1a1a";
      ctx.fillRect(0, 0, width, height);
      const barWidth = width / this.dataArray.length;
      let x = 0;
      ctx.fillStyle = "#4CAF50";
      for (let i = 0; i < this.dataArray.length; i++) {
        const barHeight = this.dataArray[i] / 255 * height;
        const gradient = ctx.createLinearGradient(x, height, x, height - barHeight);
        gradient.addColorStop(0, "#4CAF50");
        gradient.addColorStop(1, "#81C784");
        ctx.fillStyle = gradient;
        ctx.fillRect(x, height - barHeight, barWidth, barHeight);
        x += barWidth;
      }
      this.animationId = requestAnimationFrame(draw);
    };
    draw();
  }
  pause() {
    this.isPaused = true;
  }
  resume() {
    this.isPaused = false;
  }
  stop() {
    if (this.animationId !== null) {
      cancelAnimationFrame(this.animationId);
      this.animationId = null;
    }
    this.audioContext.close();
  }
};
var RecordingModal = class extends import_obsidian2.Modal {
  constructor(app, onRecordingClose, onPause, onResume, stream) {
    super(app);
    this.onPause = onPause;
    this.onResume = onResume;
    this.stream = stream;
    this.mediaRecorder = null;
    this.audioChunks = [];
    this.isRecording = false;
    this.isPaused = false;
    this.timerInterval = null;
    this.elapsedTime = 0;
    this.timerDisplay = null;
    this.visualizer = null;
    this.audioContext = null;
    this.analyser = null;
    this.dataArray = null;
    this.animationFrame = null;
    this.transcriptionText = "";
    this.isTranscribing = false;
    this.transcribingContainer = null;
    this.pauseButton = null;
    this.onRecordingClose = onRecordingClose;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const container = contentEl.createDiv("voice2text-modal-container");
    const waveformContainer = container.createDiv("voice2text-waveform-container");
    const canvas = document.createElement("canvas");
    canvas.width = 300;
    canvas.height = 100;
    canvas.className = "voice2text-waveform";
    waveformContainer.appendChild(canvas);
    const timerDisplay = container.createDiv("voice2text-timer");
    timerDisplay.setText("00:00");
    const controlsContainer = container.createDiv("voice2text-controls");
    const cancelButton = this.createCancelButton();
    cancelButton.addEventListener("click", () => {
      this.stopRecording(true);
      this.close();
    });
    const pauseButton = this.createPauseButton();
    this.updatePauseButton(this.isPaused);
    const saveButton = this.createSaveButton();
    saveButton.addEventListener("click", () => {
      this.stopRecording(false);
      this.close();
    });
    const transcriptionContainer = container.createDiv("voice2text-transcription");
    transcriptionContainer.addClass("voice2text-hidden");
    this.transcribingContainer = container.createDiv("voice2text-transcribing");
    this.transcribingContainer.addClass("voice2text-hidden");
    this.showTranscribing();
    this.initializeVisualizer(this.stream);
    this.startTimer();
  }
  createCancelButton() {
    const cancelButton = document.createElement("button");
    cancelButton.addClass("voice2text-cancel-button");
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", "18");
    line.setAttribute("y1", "6");
    line.setAttribute("x2", "6");
    line.setAttribute("y2", "18");
    const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line2.setAttribute("x1", "6");
    line2.setAttribute("y1", "6");
    line2.setAttribute("x2", "18");
    line2.setAttribute("y2", "18");
    svg.appendChild(line);
    svg.appendChild(line2);
    cancelButton.appendChild(svg);
    return cancelButton;
  }
  createPauseButton() {
    const pauseButton = document.createElement("button");
    pauseButton.addClass("voice2text-pause-button");
    return pauseButton;
  }
  createSaveButton() {
    const saveButton = document.createElement("button");
    saveButton.addClass("voice2text-save-button");
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", "M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z");
    const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline.setAttribute("points", "17 21 17 13 7 13 7 21");
    const polyline2 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline2.setAttribute("points", "7 3 7 8 15 8");
    svg.appendChild(path);
    svg.appendChild(polyline);
    svg.appendChild(polyline2);
    saveButton.appendChild(svg);
    return saveButton;
  }
  startTimer() {
    this.timerInterval = window.setInterval(() => {
      if (!this.isPaused) {
        this.elapsedTime++;
        const minutes = Math.floor(this.elapsedTime / 60);
        const seconds = this.elapsedTime % 60;
        this.timerDisplay = this.contentEl.querySelector(".voice2text-timer");
        if (this.timerDisplay) {
          this.timerDisplay.setText(`${minutes.toString().padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`);
        }
      }
    }, 1e3);
  }
  initializeVisualizer(stream) {
    const canvas = this.contentEl.querySelector(".voice2text-waveform");
    if (canvas instanceof HTMLCanvasElement) {
      this.visualizer = new AudioVisualizer(canvas);
      this.visualizer.connectStream(stream);
    }
  }
  pauseRecording() {
    var _a;
    this.isPaused = true;
    this.onPause();
    (_a = this.visualizer) == null ? void 0 : _a.pause();
  }
  resumeRecording() {
    var _a;
    this.isPaused = false;
    this.onResume();
    (_a = this.visualizer) == null ? void 0 : _a.resume();
  }
  stopRecording(cancelled = false) {
    var _a;
    if (this.mediaRecorder && this.mediaRecorder.state !== "inactive") {
      this.mediaRecorder.stop();
    }
    if (this.timerInterval) {
      clearInterval(this.timerInterval);
    }
    (_a = this.visualizer) == null ? void 0 : _a.stop();
    this.onRecordingClose(cancelled);
  }
  setTranscriptionText(text) {
    this.transcriptionText = text;
    const transcriptionContainer = this.contentEl.querySelector(".voice2text-transcription");
    if (transcriptionContainer) {
      transcriptionContainer.removeClass("voice2text-hidden");
      this.typeText(transcriptionContainer, text);
    }
  }
  showTranscribing() {
    if (this.transcribingContainer) {
      this.transcribingContainer.removeClass("voice2text-hidden");
    }
  }
  hideTranscribing() {
    if (this.transcribingContainer) {
      this.transcribingContainer.addClass("voice2text-hidden");
    }
  }
  async typeText(element, text) {
    element.empty();
    const textContainer = element.createDiv("voice2text-typing-text");
    for (let i = 0; i < text.length; i++) {
      const span = document.createElement("span");
      span.textContent = text[i];
      textContainer.appendChild(span);
      await new Promise((resolve) => setTimeout(resolve, 50));
    }
  }
  onClose() {
    var _a;
    if (this.mediaRecorder && this.mediaRecorder.state !== "inactive") {
      this.mediaRecorder.stop();
    }
    if (this.timerInterval) {
      clearInterval(this.timerInterval);
    }
    (_a = this.visualizer) == null ? void 0 : _a.stop();
    this.onRecordingClose(true);
  }
  updatePauseButton(isPaused) {
    const pauseButton = this.pauseButton;
    if (!pauseButton)
      return;
    while (pauseButton.firstChild) {
      pauseButton.removeChild(pauseButton.firstChild);
    }
    if (isPaused) {
      const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
      svg.setAttribute("width", "24");
      svg.setAttribute("height", "24");
      svg.setAttribute("viewBox", "0 0 24 24");
      svg.setAttribute("fill", "none");
      svg.setAttribute("stroke", "currentColor");
      svg.setAttribute("stroke-width", "2");
      svg.setAttribute("stroke-linecap", "round");
      svg.setAttribute("stroke-linejoin", "round");
      const rect1 = document.createElementNS("http://www.w3.org/2000/svg", "rect");
      rect1.setAttribute("x", "6");
      rect1.setAttribute("y", "4");
      rect1.setAttribute("width", "4");
      rect1.setAttribute("height", "16");
      const rect2 = document.createElementNS("http://www.w3.org/2000/svg", "rect");
      rect2.setAttribute("x", "14");
      rect2.setAttribute("y", "4");
      rect2.setAttribute("width", "4");
      rect2.setAttribute("height", "16");
      svg.appendChild(rect1);
      svg.appendChild(rect2);
      pauseButton.appendChild(svg);
    } else {
      const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
      svg.setAttribute("width", "24");
      svg.setAttribute("height", "24");
      svg.setAttribute("viewBox", "0 0 24 24");
      svg.setAttribute("fill", "none");
      svg.setAttribute("stroke", "currentColor");
      svg.setAttribute("stroke-width", "2");
      svg.setAttribute("stroke-linecap", "round");
      svg.setAttribute("stroke-linejoin", "round");
      const polygon = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
      polygon.setAttribute("points", "5 3 19 12 5 21 5 3");
      svg.appendChild(polygon);
      pauseButton.appendChild(svg);
    }
  }
  showTranscribing() {
    if (!this.transcribingContainer)
      return;
    while (this.transcribingContainer.firstChild) {
      this.transcribingContainer.removeChild(this.transcribingContainer.firstChild);
    }
    const textSpan = document.createElement("span");
    textSpan.addClass("voice2text-transcribing-text");
    textSpan.setText("AI \u8F6C\u5199\u4E2D");
    const dotsSpan = document.createElement("span");
    dotsSpan.addClass("voice2text-transcribing-dots");
    for (let i = 0; i < 3; i++) {
      const dot = document.createElement("span");
      dot.setText(".");
      dotsSpan.appendChild(dot);
    }
    this.transcribingContainer.appendChild(textSpan);
    this.transcribingContainer.appendChild(dotsSpan);
  }
};

// main.ts
var Voice2TextPlugin = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.recordingModal = null;
    this.mediaStream = null;
    this.isRecording = false;
  }
  async onload() {
    await this.loadSettings();
    this.audioRecorder = new AudioRecorder();
    this.transcriptionService = new TranscriptionService(this.settings.openaiApiKey);
    this.addSettingTab(new Voice2TextSettingTab(this.app, this, this.settings));
    this.statusBarItem = this.addStatusBarItem();
    this.statusBarItem.addClass("mod-clickable");
    this.statusBarItem.setAttribute("aria-label", "\u5F00\u59CB\u5F55\u97F3");
    this.statusBarItem.setAttribute("title", "\u70B9\u51FB\u5F00\u59CB\u5F55\u97F3");
    this.statusBarItem.innerHTML = "\u{1F399}";
    this.statusBarItem.addEventListener("click", () => {
      if (!this.isRecording) {
        this.startRecording();
      } else {
        this.stopRecording();
      }
    });
    this.addRibbonIcon("microphone", "\u8BED\u97F3\u5F55\u5236", (evt) => {
      if (!this.isRecording) {
        this.startRecording();
      } else {
        this.stopRecording();
      }
    });
    this.addCommand({
      id: "start-voice-recording",
      name: "\u5F00\u59CB\u8BED\u97F3\u5F55\u5236",
      editorCallback: (editor) => {
        this.startRecording();
      }
    });
    this.addCommand({
      id: "stop-voice-recording",
      name: "\u505C\u6B62\u8BED\u97F3\u5F55\u5236",
      editorCallback: (editor) => {
        this.stopRecording();
      }
    });
  }
  async startRecording() {
    try {
      await this.audioRecorder.startRecording();
      const stream = this.audioRecorder.getStream();
      if (!stream) {
        throw new Error("\u65E0\u6CD5\u83B7\u53D6\u97F3\u9891\u6D41");
      }
      this.isRecording = true;
      this.statusBarItem.innerHTML = "\u23F9";
      this.statusBarItem.setAttribute("aria-label", "\u505C\u6B62\u5F55\u97F3");
      this.statusBarItem.setAttribute("title", "\u70B9\u51FB\u505C\u6B62\u5F55\u97F3");
      this.recordingModal = new RecordingModal(
        this.app,
        async (cancelled) => {
          if (!cancelled) {
            await this.stopRecording();
          } else {
            this.audioRecorder.cleanup();
          }
          this.recordingModal = null;
        },
        () => this.audioRecorder.pauseRecording(),
        () => this.audioRecorder.resumeRecording(),
        stream
      );
      this.recordingModal.open();
    } catch (error) {
      new import_obsidian3.Notice("\u5F55\u97F3\u5931\u8D25: " + error.message);
    }
  }
  async stopRecording() {
    try {
      const audioBlob = await this.audioRecorder.stopRecording();
      const view = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
      if (!view) {
        new import_obsidian3.Notice("\u8BF7\u5148\u6253\u5F00\u4E00\u4E2A\u7B14\u8BB0\u6587\u4EF6");
        return;
      }
      const audioFilePath = await this.saveAudioFile(audioBlob);
      const editor = view.editor;
      const cursor = editor.getCursor();
      editor.replaceRange(`![[${audioFilePath}]]

`, cursor);
      new import_obsidian3.Notice("\u6B63\u5728\u8F6C\u5199...");
      const text = await this.transcriptionService.transcribe(audioBlob);
      if (this.recordingModal) {
        this.recordingModal.setTranscriptionText(text);
      }
      const newCursor = editor.getCursor();
      editor.replaceRange(`${text}

`, newCursor);
    } catch (error) {
      new import_obsidian3.Notice("\u8F6C\u5199\u5931\u8D25: " + error.message);
    } finally {
      this.isRecording = false;
      this.statusBarItem.innerHTML = "\u{1F399}";
      this.statusBarItem.setAttribute("aria-label", "\u5F00\u59CB\u5F55\u97F3");
      this.statusBarItem.setAttribute("title", "\u70B9\u51FB\u5F00\u59CB\u5F55\u97F3");
      if (this.mediaStream) {
        this.mediaStream.getTracks().forEach((track) => track.stop());
        this.mediaStream = null;
      }
    }
  }
  async saveAudioFile(audioBlob) {
    if (!this.settings.saveAudio) {
      return "";
    }
    const timestamp = (/* @__PURE__ */ new Date()).toISOString().replace(/[:.]/g, "-");
    const fileName = `${this.settings.audioFolder}/\u5F55\u97F3_${timestamp}.wav`;
    const folder = this.app.vault.getAbstractFileByPath(this.settings.audioFolder);
    if (!folder) {
      await this.app.vault.createFolder(this.settings.audioFolder);
    }
    const file = new File([audioBlob], fileName, { type: "audio/wav" });
    await this.app.vault.createBinary(fileName, await file.arrayBuffer());
    return fileName;
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  onunload() {
    this.audioRecorder.cleanup();
    if (this.recordingModal) {
      this.recordingModal.close();
    }
    if (this.mediaStream) {
      this.mediaStream.getTracks().forEach((track) => track.stop());
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvY29tcG9uZW50cy9BdWRpb1JlY29yZGVyLnRzIiwgInNyYy9jb21wb25lbnRzL1RyYW5zY3JpcHRpb25TZXJ2aWNlLnRzIiwgInNyYy9jb21wb25lbnRzL1NldHRpbmdzVGFiLnRzIiwgInNyYy9jb21wb25lbnRzL1JlY29yZGluZ01vZGFsLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIEVkaXRvciwgTWFya2Rvd25WaWV3LCBOb3RpY2UsIEFwcCwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBBdWRpb1JlY29yZGVyIH0gZnJvbSAnLi9zcmMvY29tcG9uZW50cy9BdWRpb1JlY29yZGVyJztcbmltcG9ydCB7IFRyYW5zY3JpcHRpb25TZXJ2aWNlIH0gZnJvbSAnLi9zcmMvY29tcG9uZW50cy9UcmFuc2NyaXB0aW9uU2VydmljZSc7XG5pbXBvcnQgeyBWb2ljZTJUZXh0U2V0dGluZ1RhYiwgVm9pY2UyVGV4dFNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zcmMvY29tcG9uZW50cy9TZXR0aW5nc1RhYic7XG5pbXBvcnQgeyBSZWNvcmRpbmdNb2RhbCB9IGZyb20gJy4vc3JjL2NvbXBvbmVudHMvUmVjb3JkaW5nTW9kYWwnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWb2ljZTJUZXh0UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgcHJpdmF0ZSBhdWRpb1JlY29yZGVyOiBBdWRpb1JlY29yZGVyO1xuICBwdWJsaWMgdHJhbnNjcmlwdGlvblNlcnZpY2U6IFRyYW5zY3JpcHRpb25TZXJ2aWNlO1xuICBwcml2YXRlIHNldHRpbmdzOiBWb2ljZTJUZXh0U2V0dGluZ3M7XG4gIHByaXZhdGUgcmVjb3JkaW5nTW9kYWw6IFJlY29yZGluZ01vZGFsIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgbWVkaWFTdHJlYW06IE1lZGlhU3RyZWFtIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgc3RhdHVzQmFySXRlbTogSFRNTEVsZW1lbnQ7XG4gIHByaXZhdGUgaXNSZWNvcmRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBhc3luYyBvbmxvYWQoKSB7XG4gICAgLy8gXHU1MkEwXHU4RjdEXHU4QkJFXHU3RjZFXG4gICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICBcbiAgICAvLyBcdTUyMURcdTU5Q0JcdTUzMTZcdTdFQzRcdTRFRjZcbiAgICB0aGlzLmF1ZGlvUmVjb3JkZXIgPSBuZXcgQXVkaW9SZWNvcmRlcigpO1xuICAgIHRoaXMudHJhbnNjcmlwdGlvblNlcnZpY2UgPSBuZXcgVHJhbnNjcmlwdGlvblNlcnZpY2UodGhpcy5zZXR0aW5ncy5vcGVuYWlBcGlLZXkpO1xuXG4gICAgLy8gXHU2REZCXHU1MkEwXHU4QkJFXHU3RjZFXHU2ODA3XHU3QjdFXHU5ODc1XG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBWb2ljZTJUZXh0U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcywgdGhpcy5zZXR0aW5ncykpO1xuXG4gICAgLy8gXHU2REZCXHU1MkEwXHU3MkI2XHU2MDAxXHU2ODBGXHU2MzA5XHU5NEFFXG4gICAgdGhpcy5zdGF0dXNCYXJJdGVtID0gdGhpcy5hZGRTdGF0dXNCYXJJdGVtKCk7XG4gICAgdGhpcy5zdGF0dXNCYXJJdGVtLmFkZENsYXNzKCdtb2QtY2xpY2thYmxlJyk7XG4gICAgdGhpcy5zdGF0dXNCYXJJdGVtLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdcdTVGMDBcdTU5Q0JcdTVGNTVcdTk3RjMnKTtcbiAgICB0aGlzLnN0YXR1c0Jhckl0ZW0uc2V0QXR0cmlidXRlKCd0aXRsZScsICdcdTcwQjlcdTUxRkJcdTVGMDBcdTU5Q0JcdTVGNTVcdTk3RjMnKTtcbiAgICB0aGlzLnN0YXR1c0Jhckl0ZW0uaW5uZXJIVE1MID0gJ1x1RDgzQ1x1REY5OSc7XG4gICAgdGhpcy5zdGF0dXNCYXJJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmlzUmVjb3JkaW5nKSB7XG4gICAgICAgIHRoaXMuc3RhcnRSZWNvcmRpbmcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3RvcFJlY29yZGluZygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gXHU2REZCXHU1MkEwXHU1RjU1XHU5N0YzXHU2MzA5XHU5NEFFXHU1MjMwXHU3RjE2XHU4RjkxXHU1NjY4XHU1REU1XHU1MTc3XHU2ODBGXG4gICAgdGhpcy5hZGRSaWJib25JY29uKCdtaWNyb3Bob25lJywgJ1x1OEJFRFx1OTdGM1x1NUY1NVx1NTIzNicsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmICghdGhpcy5pc1JlY29yZGluZykge1xuICAgICAgICB0aGlzLnN0YXJ0UmVjb3JkaW5nKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN0b3BSZWNvcmRpbmcoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFx1NkRGQlx1NTJBMFx1NUYwMFx1NTlDQlx1NUY1NVx1OTdGM1x1NTQ3RFx1NEVFNFxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICBpZDogJ3N0YXJ0LXZvaWNlLXJlY29yZGluZycsXG4gICAgICBuYW1lOiAnXHU1RjAwXHU1OUNCXHU4QkVEXHU5N0YzXHU1RjU1XHU1MjM2JyxcbiAgICAgIGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgdGhpcy5zdGFydFJlY29yZGluZygpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIC8vIFx1NkRGQlx1NTJBMFx1NTA1Q1x1NkI2Mlx1NUY1NVx1OTdGM1x1NTQ3RFx1NEVFNFxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICBpZDogJ3N0b3Atdm9pY2UtcmVjb3JkaW5nJyxcbiAgICAgIG5hbWU6ICdcdTUwNUNcdTZCNjJcdThCRURcdTk3RjNcdTVGNTVcdTUyMzYnLFxuICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICB0aGlzLnN0b3BSZWNvcmRpbmcoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0UmVjb3JkaW5nKCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLmF1ZGlvUmVjb3JkZXIuc3RhcnRSZWNvcmRpbmcoKTtcbiAgICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuYXVkaW9SZWNvcmRlci5nZXRTdHJlYW0oKTtcbiAgICAgIGlmICghc3RyZWFtKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignXHU2NUUwXHU2Q0Q1XHU4M0I3XHU1M0Q2XHU5N0YzXHU5ODkxXHU2RDQxJyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRoaXMuaXNSZWNvcmRpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLmlubmVySFRNTCA9ICdcdTIzRjknO1xuICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdcdTUwNUNcdTZCNjJcdTVGNTVcdTk3RjMnKTtcbiAgICAgIHRoaXMuc3RhdHVzQmFySXRlbS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgJ1x1NzBCOVx1NTFGQlx1NTA1Q1x1NkI2Mlx1NUY1NVx1OTdGMycpO1xuXG4gICAgICB0aGlzLnJlY29yZGluZ01vZGFsID0gbmV3IFJlY29yZGluZ01vZGFsKFxuICAgICAgICB0aGlzLmFwcCxcbiAgICAgICAgYXN5bmMgKGNhbmNlbGxlZCkgPT4ge1xuICAgICAgICAgIGlmICghY2FuY2VsbGVkKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN0b3BSZWNvcmRpbmcoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hdWRpb1JlY29yZGVyLmNsZWFudXAoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5yZWNvcmRpbmdNb2RhbCA9IG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgICgpID0+IHRoaXMuYXVkaW9SZWNvcmRlci5wYXVzZVJlY29yZGluZygpLFxuICAgICAgICAoKSA9PiB0aGlzLmF1ZGlvUmVjb3JkZXIucmVzdW1lUmVjb3JkaW5nKCksXG4gICAgICAgIHN0cmVhbVxuICAgICAgKTtcbiAgICAgIHRoaXMucmVjb3JkaW5nTW9kYWwub3BlbigpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXcgTm90aWNlKCdcdTVGNTVcdTk3RjNcdTU5MzFcdThEMjU6ICcgKyBlcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBzdG9wUmVjb3JkaW5nKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBhdWRpb0Jsb2IgPSBhd2FpdCB0aGlzLmF1ZGlvUmVjb3JkZXIuc3RvcFJlY29yZGluZygpO1xuICAgICAgXG4gICAgICAvLyBcdTgzQjdcdTUzRDZcdTVGNTNcdTUyNERcdTdCMTRcdThCQjBcbiAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgIG5ldyBOb3RpY2UoJ1x1OEJGN1x1NTE0OFx1NjI1M1x1NUYwMFx1NEUwMFx1NEUyQVx1N0IxNFx1OEJCMFx1NjU4N1x1NEVGNicpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFx1NEZERFx1NUI1OFx1OTdGM1x1OTg5MVx1NjU4N1x1NEVGNlxuICAgICAgY29uc3QgYXVkaW9GaWxlUGF0aCA9IGF3YWl0IHRoaXMuc2F2ZUF1ZGlvRmlsZShhdWRpb0Jsb2IpO1xuICAgICAgXG4gICAgICAvLyBcdTUxNDhcdTYzRDJcdTUxNjVcdTk3RjNcdTk4OTFcdTY1ODdcdTRFRjZcdTk0RkVcdTYzQTVcbiAgICAgIGNvbnN0IGVkaXRvciA9IHZpZXcuZWRpdG9yO1xuICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShgIVtbJHthdWRpb0ZpbGVQYXRofV1dXFxuXFxuYCwgY3Vyc29yKTtcbiAgICAgIFxuICAgICAgLy8gXHU1RjAwXHU1OUNCXHU4RjZDXHU1MTk5XHU1RTc2XHU2NjNFXHU3OTNBXHU4RkRCXHU1RUE2XG4gICAgICBuZXcgTm90aWNlKCdcdTZCNjNcdTU3MjhcdThGNkNcdTUxOTkuLi4nKTtcbiAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCB0aGlzLnRyYW5zY3JpcHRpb25TZXJ2aWNlLnRyYW5zY3JpYmUoYXVkaW9CbG9iKTtcbiAgICAgIFxuICAgICAgLy8gXHU1NzI4XHU1RjM5XHU3QTk3XHU0RTJEXHU2NjNFXHU3OTNBXHU4RjZDXHU1MTk5XHU2NTg3XHU2NzJDXHVGRjA4XHU1RTI2XHU2MjUzXHU1QjU3XHU2NTQ4XHU2NzlDXHVGRjA5XG4gICAgICBpZiAodGhpcy5yZWNvcmRpbmdNb2RhbCkge1xuICAgICAgICB0aGlzLnJlY29yZGluZ01vZGFsLnNldFRyYW5zY3JpcHRpb25UZXh0KHRleHQpO1xuICAgICAgfVxuXG4gICAgICAvLyBcdTU3MjhcdTk3RjNcdTk4OTFcdTY1ODdcdTRFRjZcdTk0RkVcdTYzQTVcdTU0MEVcdTYzRDJcdTUxNjVcdThGNkNcdTUxOTlcdTY1ODdcdTY3MkNcbiAgICAgIGNvbnN0IG5ld0N1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoYCR7dGV4dH1cXG5cXG5gLCBuZXdDdXJzb3IpO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIG5ldyBOb3RpY2UoJ1x1OEY2Q1x1NTE5OVx1NTkzMVx1OEQyNTogJyArIGVycm9yLm1lc3NhZ2UpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmlzUmVjb3JkaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLnN0YXR1c0Jhckl0ZW0uaW5uZXJIVE1MID0gJ1x1RDgzQ1x1REY5OSc7XG4gICAgICB0aGlzLnN0YXR1c0Jhckl0ZW0uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1x1NUYwMFx1NTlDQlx1NUY1NVx1OTdGMycpO1xuICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAnXHU3MEI5XHU1MUZCXHU1RjAwXHU1OUNCXHU1RjU1XHU5N0YzJyk7XG4gICAgICBcbiAgICAgIGlmICh0aGlzLm1lZGlhU3RyZWFtKSB7XG4gICAgICAgIHRoaXMubWVkaWFTdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCh0cmFjayA9PiB0cmFjay5zdG9wKCkpO1xuICAgICAgICB0aGlzLm1lZGlhU3RyZWFtID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBzYXZlQXVkaW9GaWxlKGF1ZGlvQmxvYjogQmxvYik6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgaWYgKCF0aGlzLnNldHRpbmdzLnNhdmVBdWRpbykge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9bOi5dL2csICctJyk7XG4gICAgY29uc3QgZmlsZU5hbWUgPSBgJHt0aGlzLnNldHRpbmdzLmF1ZGlvRm9sZGVyfS9cdTVGNTVcdTk3RjNfJHt0aW1lc3RhbXB9LndhdmA7XG4gICAgXG4gICAgLy8gXHU3ODZFXHU0RkREXHU3NkVFXHU2ODA3XHU2NTg3XHU0RUY2XHU1OTM5XHU1QjU4XHU1NzI4XG4gICAgY29uc3QgZm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuc2V0dGluZ3MuYXVkaW9Gb2xkZXIpO1xuICAgIGlmICghZm9sZGVyKSB7XG4gICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIodGhpcy5zZXR0aW5ncy5hdWRpb0ZvbGRlcik7XG4gICAgfVxuXG4gICAgY29uc3QgZmlsZSA9IG5ldyBGaWxlKFthdWRpb0Jsb2JdLCBmaWxlTmFtZSwgeyB0eXBlOiAnYXVkaW8vd2F2JyB9KTtcbiAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVCaW5hcnkoZmlsZU5hbWUsIGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKSk7XG4gICAgcmV0dXJuIGZpbGVOYW1lO1xuICB9XG5cbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gIH1cblxuICBvbnVubG9hZCgpIHtcbiAgICB0aGlzLmF1ZGlvUmVjb3JkZXIuY2xlYW51cCgpO1xuICAgIGlmICh0aGlzLnJlY29yZGluZ01vZGFsKSB7XG4gICAgICB0aGlzLnJlY29yZGluZ01vZGFsLmNsb3NlKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLm1lZGlhU3RyZWFtKSB7XG4gICAgICB0aGlzLm1lZGlhU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4gdHJhY2suc3RvcCgpKTtcbiAgICB9XG4gIH1cbn0iLCAiZXhwb3J0IGNsYXNzIEF1ZGlvUmVjb3JkZXIge1xuICBwcml2YXRlIG1lZGlhUmVjb3JkZXI6IE1lZGlhUmVjb3JkZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBhdWRpb0NodW5rczogQmxvYltdID0gW107XG4gIHByaXZhdGUgaXNSZWNvcmRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBpc1BhdXNlZDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIHN0cmVhbTogTWVkaWFTdHJlYW0gfCBudWxsID0gbnVsbDtcblxuICBhc3luYyBzdGFydFJlY29yZGluZygpIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5zdHJlYW0gPSBhd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7IGF1ZGlvOiB0cnVlIH0pO1xuICAgICAgdGhpcy5tZWRpYVJlY29yZGVyID0gbmV3IE1lZGlhUmVjb3JkZXIodGhpcy5zdHJlYW0pO1xuICAgICAgdGhpcy5tZWRpYVJlY29yZGVyLm9uZGF0YWF2YWlsYWJsZSA9IChldmVudCkgPT4ge1xuICAgICAgICB0aGlzLmF1ZGlvQ2h1bmtzLnB1c2goZXZlbnQuZGF0YSk7XG4gICAgICB9O1xuICAgICAgdGhpcy5tZWRpYVJlY29yZGVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmlzUmVjb3JkaW5nID0gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdcdTY1RTBcdTZDRDVcdThCQkZcdTk1RUVcdTlFQTZcdTUxNEJcdTk4Q0UnKTtcbiAgICB9XG4gIH1cblxuICBwYXVzZVJlY29yZGluZygpIHtcbiAgICBpZiAodGhpcy5tZWRpYVJlY29yZGVyICYmIHRoaXMuaXNSZWNvcmRpbmcpIHtcbiAgICAgIHRoaXMubWVkaWFSZWNvcmRlci5wYXVzZSgpO1xuICAgICAgdGhpcy5pc1BhdXNlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmVzdW1lUmVjb3JkaW5nKCkge1xuICAgIGlmICh0aGlzLm1lZGlhUmVjb3JkZXIgJiYgdGhpcy5pc1BhdXNlZCkge1xuICAgICAgdGhpcy5tZWRpYVJlY29yZGVyLnJlc3VtZSgpO1xuICAgICAgdGhpcy5pc1BhdXNlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHN0b3BSZWNvcmRpbmcoKTogUHJvbWlzZTxCbG9iPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBpZiAodGhpcy5tZWRpYVJlY29yZGVyKSB7XG4gICAgICAgIHRoaXMubWVkaWFSZWNvcmRlci5vbnN0b3AgPSAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgYXVkaW9CbG9iID0gbmV3IEJsb2IodGhpcy5hdWRpb0NodW5rcywgeyB0eXBlOiAnYXVkaW8vd2F2JyB9KTtcbiAgICAgICAgICB0aGlzLmF1ZGlvQ2h1bmtzID0gW107XG4gICAgICAgICAgcmVzb2x2ZShhdWRpb0Jsb2IpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm1lZGlhUmVjb3JkZXIuc3RvcCgpO1xuICAgICAgICB0aGlzLmlzUmVjb3JkaW5nID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBnZXRTdHJlYW0oKTogTWVkaWFTdHJlYW0gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5zdHJlYW07XG4gIH1cblxuICBjbGVhbnVwKCkge1xuICAgIGlmICh0aGlzLm1lZGlhUmVjb3JkZXIpIHtcbiAgICAgIGlmICh0aGlzLmlzUmVjb3JkaW5nKSB7XG4gICAgICAgIHRoaXMubWVkaWFSZWNvcmRlci5zdG9wKCk7XG4gICAgICB9XG4gICAgICB0aGlzLm1lZGlhUmVjb3JkZXIgPSBudWxsO1xuICAgIH1cbiAgICBpZiAodGhpcy5zdHJlYW0pIHtcbiAgICAgIHRoaXMuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4gdHJhY2suc3RvcCgpKTtcbiAgICAgIHRoaXMuc3RyZWFtID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5hdWRpb0NodW5rcyA9IFtdO1xuICAgIHRoaXMuaXNSZWNvcmRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmlzUGF1c2VkID0gZmFsc2U7XG4gIH1cbn0iLCAiZXhwb3J0IGNsYXNzIFRyYW5zY3JpcHRpb25TZXJ2aWNlIHtcbiAgcHJpdmF0ZSBhcGlLZXk6IHN0cmluZztcbiAgcHJpdmF0ZSBhcGlFbmRwb2ludDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKGFwaUtleTogc3RyaW5nID0gJycpIHtcbiAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICB0aGlzLmFwaUVuZHBvaW50ID0gJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvYXVkaW8vdHJhbnNjcmlwdGlvbnMnO1xuICB9XG5cbiAgc2V0QXBpS2V5KGtleTogc3RyaW5nKSB7XG4gICAgdGhpcy5hcGlLZXkgPSBrZXk7XG4gIH1cblxuICBnZXRBcGlLZXkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5hcGlLZXk7XG4gIH1cblxuICBhc3luYyB0cmFuc2NyaWJlKGF1ZGlvQmxvYjogQmxvYik6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgaWYgKCF0aGlzLmFwaUtleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdcdThCRjdcdTUxNDhcdTU3MjhcdThCQkVcdTdGNkVcdTRFMkRcdTkxNERcdTdGNkUgT3BlbkFJIEFQSSBLZXknKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGF1ZGlvQmxvYiwgJ2F1ZGlvLndhdicpO1xuICAgIGZvcm1EYXRhLmFwcGVuZCgnbW9kZWwnLCAnd2hpc3Blci0xJyk7XG4gICAgZm9ybURhdGEuYXBwZW5kKCdsYW5ndWFnZScsICd6aCcpO1xuICAgIGZvcm1EYXRhLmFwcGVuZCgncmVzcG9uc2VfZm9ybWF0JywgJ2pzb24nKTtcbiAgICBmb3JtRGF0YS5hcHBlbmQoJ3RlbXBlcmF0dXJlJywgJzAnKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMuYXBpRW5kcG9pbnQsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IGZvcm1EYXRhXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1x1OEY2Q1x1NTE5OVx1OEJGN1x1NkM0Mlx1NTkzMVx1OEQyNTogJyArIHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICByZXR1cm4gZGF0YS50ZXh0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1x1OEJFRFx1OTdGM1x1OEY2Q1x1NTE5OVx1NTkzMVx1OEQyNTogJyArIGVycm9yLm1lc3NhZ2UpO1xuICAgIH1cbiAgfVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFRyYW5zY3JpcHRpb25TZXJ2aWNlIH0gZnJvbSAnLi9UcmFuc2NyaXB0aW9uU2VydmljZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVm9pY2UyVGV4dFNldHRpbmdzIHtcbiAgb3BlbmFpQXBpS2V5OiBzdHJpbmc7XG4gIHNhdmVBdWRpbzogYm9vbGVhbjtcbiAgYXVkaW9Gb2xkZXI6IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFZvaWNlMlRleHRTZXR0aW5ncyA9IHtcbiAgb3BlbmFpQXBpS2V5OiAnJyxcbiAgc2F2ZUF1ZGlvOiB0cnVlLFxuICBhdWRpb0ZvbGRlcjogJ3JlY29yZGluZ3MnXG59O1xuXG5pbnRlcmZhY2UgVm9pY2UyVGV4dFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gIHRyYW5zY3JpcHRpb25TZXJ2aWNlOiBUcmFuc2NyaXB0aW9uU2VydmljZTtcbn1cblxuZXhwb3J0IGNsYXNzIFZvaWNlMlRleHRTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGFwcDogQXBwLFxuICAgIHByaXZhdGUgcGx1Z2luOiBWb2ljZTJUZXh0UGx1Z2luLFxuICAgIHByaXZhdGUgc2V0dGluZ3M6IFZvaWNlMlRleHRTZXR0aW5nc1xuICApIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gIH1cblxuICBkaXNwbGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1x1OEJFRFx1OTdGM1x1OEY2Q1x1NjU4N1x1NUI1N1x1OEJCRVx1N0Y2RScgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdPcGVuQUkgQVBJIEtleScpXG4gICAgICAuc2V0RGVzYygnXHU4QkY3XHU4RjkzXHU1MTY1XHU2MEE4XHU3Njg0IE9wZW5BSSBBUEkgS2V5JylcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1x1OEY5M1x1NTE2NVx1NjBBOFx1NzY4NCBBUEkgS2V5JylcbiAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3Mub3BlbmFpQXBpS2V5KVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5zZXR0aW5ncy5vcGVuYWlBcGlLZXkgPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgICB0aGlzLnBsdWdpbi50cmFuc2NyaXB0aW9uU2VydmljZS5zZXRBcGlLZXkodmFsdWUpO1xuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdcdTRGRERcdTVCNThcdTk3RjNcdTk4OTFcdTY1ODdcdTRFRjYnKVxuICAgICAgLnNldERlc2MoJ1x1NjYyRlx1NTQyNlx1NEZERFx1NUI1OFx1NUY1NVx1OTdGM1x1NjU4N1x1NEVGNlx1NTIzMFx1NjU4N1x1Njg2M1x1NUU5MycpXG4gICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3Muc2F2ZUF1ZGlvKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5zZXR0aW5ncy5zYXZlQXVkaW8gPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZSgnXHU5N0YzXHU5ODkxXHU2NTg3XHU0RUY2XHU0RkREXHU1QjU4XHU4REVGXHU1Rjg0JylcbiAgICAgIC5zZXREZXNjKCdcdThCQkVcdTdGNkVcdTVGNTVcdTk3RjNcdTY1ODdcdTRFRjZcdTc2ODRcdTRGRERcdTVCNThcdThERUZcdTVGODRcdUZGMENcdTlFRDhcdThCQTRcdTRFM0EgcmVjb3JkaW5ncyBcdTY1ODdcdTRFRjZcdTU5MzknKVxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignXHU4RjkzXHU1MTY1XHU0RkREXHU1QjU4XHU4REVGXHU1Rjg0JylcbiAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3MuYXVkaW9Gb2xkZXIpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnNldHRpbmdzLmF1ZGlvRm9sZGVyID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIH0pKTtcbiAgfVxufSAiLCAiaW1wb3J0IHsgTW9kYWwsIEFwcCwgc2V0SWNvbiB9IGZyb20gJ29ic2lkaWFuJztcblxuY2xhc3MgQXVkaW9WaXN1YWxpemVyIHtcbiAgcHJpdmF0ZSBhdWRpb0NvbnRleHQ6IEF1ZGlvQ29udGV4dDtcbiAgcHJpdmF0ZSBhbmFseXNlcjogQW5hbHlzZXJOb2RlO1xuICBwcml2YXRlIGRhdGFBcnJheTogVWludDhBcnJheTtcbiAgcHJpdmF0ZSBhbmltYXRpb25JZDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgaXNQYXVzZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpIHtcbiAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcbiAgICB0aGlzLmFuYWx5c2VyID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlQW5hbHlzZXIoKTtcbiAgICB0aGlzLmFuYWx5c2VyLmZmdFNpemUgPSAyNTY7XG4gICAgdGhpcy5kYXRhQXJyYXkgPSBuZXcgVWludDhBcnJheSh0aGlzLmFuYWx5c2VyLmZyZXF1ZW5jeUJpbkNvdW50KTtcbiAgfVxuXG4gIGNvbm5lY3RTdHJlYW0oc3RyZWFtOiBNZWRpYVN0cmVhbSkge1xuICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG4gICAgc291cmNlLmNvbm5lY3QodGhpcy5hbmFseXNlcik7XG4gICAgdGhpcy5zdGFydFZpc3VhbGl6YXRpb24oKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhcnRWaXN1YWxpemF0aW9uKCkge1xuICAgIGNvbnN0IGRyYXcgPSAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5pc1BhdXNlZCkge1xuICAgICAgICB0aGlzLmFuaW1hdGlvbklkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRyYXcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYW5hbHlzZXIuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEodGhpcy5kYXRhQXJyYXkpO1xuICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLmNhbnZhcy53aWR0aDtcbiAgICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuY2FudmFzLmhlaWdodDtcbiAgICAgIGNvbnN0IGN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICAgIGlmICghY3R4KSByZXR1cm47XG5cbiAgICAgIC8vIFx1NkUwNVx1OTY2NFx1NzUzQlx1NUUwM1xuICAgICAgY3R4LmZpbGxTdHlsZSA9ICcjMWExYTFhJztcbiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgLy8gXHU3RUQ4XHU1MjM2XHU2Q0UyXHU1RjYyXG4gICAgICBjb25zdCBiYXJXaWR0aCA9IHdpZHRoIC8gdGhpcy5kYXRhQXJyYXkubGVuZ3RoO1xuICAgICAgbGV0IHggPSAwO1xuXG4gICAgICBjdHguZmlsbFN0eWxlID0gJyM0Q0FGNTAnO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGFBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBiYXJIZWlnaHQgPSAodGhpcy5kYXRhQXJyYXlbaV0gLyAyNTUpICogaGVpZ2h0O1xuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTZFMTBcdTUzRDhcdTY1NDhcdTY3OUNcbiAgICAgICAgY29uc3QgZ3JhZGllbnQgPSBjdHguY3JlYXRlTGluZWFyR3JhZGllbnQoeCwgaGVpZ2h0LCB4LCBoZWlnaHQgLSBiYXJIZWlnaHQpO1xuICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMCwgJyM0Q0FGNTAnKTtcbiAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsICcjODFDNzg0Jyk7XG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBncmFkaWVudDtcbiAgICAgICAgY3R4LmZpbGxSZWN0KHgsIGhlaWdodCAtIGJhckhlaWdodCwgYmFyV2lkdGgsIGJhckhlaWdodCk7XG4gICAgICAgIHggKz0gYmFyV2lkdGg7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYW5pbWF0aW9uSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHJhdyk7XG4gICAgfTtcblxuICAgIGRyYXcoKTtcbiAgfVxuXG4gIHBhdXNlKCkge1xuICAgIHRoaXMuaXNQYXVzZWQgPSB0cnVlO1xuICB9XG5cbiAgcmVzdW1lKCkge1xuICAgIHRoaXMuaXNQYXVzZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uSWQgIT09IG51bGwpIHtcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuYW5pbWF0aW9uSWQpO1xuICAgICAgdGhpcy5hbmltYXRpb25JZCA9IG51bGw7XG4gICAgfVxuICAgIHRoaXMuYXVkaW9Db250ZXh0LmNsb3NlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlY29yZGluZ01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICBwcml2YXRlIG1lZGlhUmVjb3JkZXI6IE1lZGlhUmVjb3JkZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBhdWRpb0NodW5rczogQmxvYltdID0gW107XG4gIHByaXZhdGUgaXNSZWNvcmRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBpc1BhdXNlZDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIHRpbWVySW50ZXJ2YWw6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGVsYXBzZWRUaW1lOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIHRpbWVyRGlzcGxheTogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSB2aXN1YWxpemVyOiBBdWRpb1Zpc3VhbGl6ZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBhdWRpb0NvbnRleHQ6IEF1ZGlvQ29udGV4dCB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGFuYWx5c2VyOiBBbmFseXNlck5vZGUgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBkYXRhQXJyYXk6IFVpbnQ4QXJyYXkgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBhbmltYXRpb25GcmFtZTogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgdHJhbnNjcmlwdGlvblRleHQ6IHN0cmluZyA9ICcnO1xuICBwcml2YXRlIGlzVHJhbnNjcmliaW5nOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgdHJhbnNjcmliaW5nQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHBhdXNlQnV0dG9uOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIG9uUmVjb3JkaW5nQ2xvc2U6IChjYW5jZWxsZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgYXBwOiBBcHAsXG4gICAgb25SZWNvcmRpbmdDbG9zZTogKGNhbmNlbGxlZDogYm9vbGVhbikgPT4gdm9pZCxcbiAgICBwcml2YXRlIG9uUGF1c2U6ICgpID0+IHZvaWQsXG4gICAgcHJpdmF0ZSBvblJlc3VtZTogKCkgPT4gdm9pZCxcbiAgICBwcml2YXRlIHN0cmVhbTogTWVkaWFTdHJlYW1cbiAgKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm9uUmVjb3JkaW5nQ2xvc2UgPSBvblJlY29yZGluZ0Nsb3NlO1xuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgLy8gXHU1MjFCXHU1RUZBXHU1RjU1XHU5N0YzXHU1RjM5XHU3QTk3XHU1MTg1XHU1QkI5XG4gICAgY29uc3QgY29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdigndm9pY2UydGV4dC1tb2RhbC1jb250YWluZXInKTtcbiAgICBcbiAgICAvLyBcdTUyMUJcdTVFRkFcdTZDRTJcdTVGNjJcdTU2RkVcdTVCQjlcdTU2NjhcbiAgICBjb25zdCB3YXZlZm9ybUNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoJ3ZvaWNlMnRleHQtd2F2ZWZvcm0tY29udGFpbmVyJyk7XG4gICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgY2FudmFzLndpZHRoID0gMzAwO1xuICAgIGNhbnZhcy5oZWlnaHQgPSAxMDA7XG4gICAgY2FudmFzLmNsYXNzTmFtZSA9ICd2b2ljZTJ0ZXh0LXdhdmVmb3JtJztcbiAgICB3YXZlZm9ybUNvbnRhaW5lci5hcHBlbmRDaGlsZChjYW52YXMpO1xuXG4gICAgLy8gXHU1MjFCXHU1RUZBXHU4QkExXHU2NUY2XHU1NjY4XHU2NjNFXHU3OTNBXG4gICAgY29uc3QgdGltZXJEaXNwbGF5ID0gY29udGFpbmVyLmNyZWF0ZURpdigndm9pY2UydGV4dC10aW1lcicpO1xuICAgIHRpbWVyRGlzcGxheS5zZXRUZXh0KCcwMDowMCcpO1xuXG4gICAgLy8gXHU1MjFCXHU1RUZBXHU2M0E3XHU1MjM2XHU2MzA5XHU5NEFFXHU1QkI5XHU1NjY4XG4gICAgY29uc3QgY29udHJvbHNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCd2b2ljZTJ0ZXh0LWNvbnRyb2xzJyk7XG4gICAgXG4gICAgLy8gXHU1MjFCXHU1RUZBXHU1M0Q2XHU2RDg4XHU2MzA5XHU5NEFFXG4gICAgY29uc3QgY2FuY2VsQnV0dG9uID0gdGhpcy5jcmVhdGVDYW5jZWxCdXR0b24oKTtcbiAgICBjYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnN0b3BSZWNvcmRpbmcodHJ1ZSk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG5cbiAgICAvLyBcdTUyMUJcdTVFRkFcdTY2ODJcdTUwNUMvXHU3RUU3XHU3RUVEXHU2MzA5XHU5NEFFXG4gICAgY29uc3QgcGF1c2VCdXR0b24gPSB0aGlzLmNyZWF0ZVBhdXNlQnV0dG9uKCk7XG4gICAgdGhpcy51cGRhdGVQYXVzZUJ1dHRvbih0aGlzLmlzUGF1c2VkKTtcblxuICAgIC8vIFx1NTIxQlx1NUVGQVx1NEZERFx1NUI1OFx1NjMwOVx1OTRBRVxuICAgIGNvbnN0IHNhdmVCdXR0b24gPSB0aGlzLmNyZWF0ZVNhdmVCdXR0b24oKTtcbiAgICBzYXZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zdG9wUmVjb3JkaW5nKGZhbHNlKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIC8vIFx1NTIxQlx1NUVGQVx1OEY2Q1x1NTE5OVx1NjU4N1x1NjcyQ1x1NUJCOVx1NTY2OFxuICAgIGNvbnN0IHRyYW5zY3JpcHRpb25Db250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCd2b2ljZTJ0ZXh0LXRyYW5zY3JpcHRpb24nKTtcbiAgICB0cmFuc2NyaXB0aW9uQ29udGFpbmVyLmFkZENsYXNzKCd2b2ljZTJ0ZXh0LWhpZGRlbicpO1xuXG4gICAgLy8gXHU1MjFCXHU1RUZBXHU4RjZDXHU1MTk5XHU3MkI2XHU2MDAxXHU1QkI5XHU1NjY4XG4gICAgdGhpcy50cmFuc2NyaWJpbmdDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCd2b2ljZTJ0ZXh0LXRyYW5zY3JpYmluZycpO1xuICAgIHRoaXMudHJhbnNjcmliaW5nQ29udGFpbmVyLmFkZENsYXNzKCd2b2ljZTJ0ZXh0LWhpZGRlbicpO1xuICAgIHRoaXMuc2hvd1RyYW5zY3JpYmluZygpO1xuXG4gICAgLy8gXHU1MjFEXHU1OUNCXHU1MzE2XHU5N0YzXHU5ODkxXHU1M0VGXHU4OUM2XHU1MzE2XHU1NjY4XG4gICAgdGhpcy5pbml0aWFsaXplVmlzdWFsaXplcih0aGlzLnN0cmVhbSk7XG5cbiAgICAvLyBcdTVGMDBcdTU5Q0JcdThCQTFcdTY1RjZcbiAgICB0aGlzLnN0YXJ0VGltZXIoKTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQ2FuY2VsQnV0dG9uKCk6IEhUTUxFbGVtZW50IHtcbiAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBjYW5jZWxCdXR0b24uYWRkQ2xhc3MoJ3ZvaWNlMnRleHQtY2FuY2VsLWJ1dHRvbicpO1xuICAgIFxuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAyNCAyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XG4gICAgXG4gICAgY29uc3QgbGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUuc2V0QXR0cmlidXRlKCd4MScsICcxOCcpO1xuICAgIGxpbmUuc2V0QXR0cmlidXRlKCd5MScsICc2Jyk7XG4gICAgbGluZS5zZXRBdHRyaWJ1dGUoJ3gyJywgJzYnKTtcbiAgICBsaW5lLnNldEF0dHJpYnV0ZSgneTInLCAnMTgnKTtcbiAgICBcbiAgICBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnNicpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnNicpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDInLCAnMTgnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kyJywgJzE4Jyk7XG4gICAgXG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XG4gICAgY2FuY2VsQnV0dG9uLmFwcGVuZENoaWxkKHN2Zyk7XG4gICAgXG4gICAgcmV0dXJuIGNhbmNlbEJ1dHRvbjtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlUGF1c2VCdXR0b24oKTogSFRNTEVsZW1lbnQge1xuICAgIGNvbnN0IHBhdXNlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgcGF1c2VCdXR0b24uYWRkQ2xhc3MoJ3ZvaWNlMnRleHQtcGF1c2UtYnV0dG9uJyk7XG4gICAgXG4gICAgcmV0dXJuIHBhdXNlQnV0dG9uO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVTYXZlQnV0dG9uKCk6IEhUTUxFbGVtZW50IHtcbiAgICBjb25zdCBzYXZlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgc2F2ZUJ1dHRvbi5hZGRDbGFzcygndm9pY2UydGV4dC1zYXZlLWJ1dHRvbicpO1xuICAgIFxuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAyNCAyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XG4gICAgXG4gICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpO1xuICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgJ00xOSAyMUg1YTIgMiAwIDAgMS0yLTJWNWEyIDIgMCAwIDEgMi0yaDExbDUgNXYxMWEyIDIgMCAwIDEtMiAyeicpO1xuICAgIFxuICAgIGNvbnN0IHBvbHlsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5bGluZScpO1xuICAgIHBvbHlsaW5lLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzE3IDIxIDE3IDEzIDcgMTMgNyAyMScpO1xuICAgIFxuICAgIGNvbnN0IHBvbHlsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcbiAgICBwb2x5bGluZTIuc2V0QXR0cmlidXRlKCdwb2ludHMnLCAnNyAzIDcgOCAxNSA4Jyk7XG4gICAgXG4gICAgc3ZnLmFwcGVuZENoaWxkKHBhdGgpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZSk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lMik7XG4gICAgc2F2ZUJ1dHRvbi5hcHBlbmRDaGlsZChzdmcpO1xuICAgIFxuICAgIHJldHVybiBzYXZlQnV0dG9uO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGFydFRpbWVyKCkge1xuICAgIHRoaXMudGltZXJJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuaXNQYXVzZWQpIHtcbiAgICAgICAgdGhpcy5lbGFwc2VkVGltZSsrO1xuICAgICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcih0aGlzLmVsYXBzZWRUaW1lIC8gNjApO1xuICAgICAgICBjb25zdCBzZWNvbmRzID0gdGhpcy5lbGFwc2VkVGltZSAlIDYwO1xuICAgICAgICB0aGlzLnRpbWVyRGlzcGxheSA9IHRoaXMuY29udGVudEVsLnF1ZXJ5U2VsZWN0b3IoJy52b2ljZTJ0ZXh0LXRpbWVyJyk7XG4gICAgICAgIGlmICh0aGlzLnRpbWVyRGlzcGxheSkge1xuICAgICAgICAgIHRoaXMudGltZXJEaXNwbGF5LnNldFRleHQoYCR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7c2Vjb25kcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCAxMDAwKTtcbiAgfVxuXG4gIHByaXZhdGUgaW5pdGlhbGl6ZVZpc3VhbGl6ZXIoc3RyZWFtOiBNZWRpYVN0cmVhbSk6IHZvaWQge1xuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY29udGVudEVsLnF1ZXJ5U2VsZWN0b3IoJy52b2ljZTJ0ZXh0LXdhdmVmb3JtJyk7XG4gICAgaWYgKGNhbnZhcyBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50KSB7XG4gICAgICB0aGlzLnZpc3VhbGl6ZXIgPSBuZXcgQXVkaW9WaXN1YWxpemVyKGNhbnZhcyk7XG4gICAgICB0aGlzLnZpc3VhbGl6ZXIuY29ubmVjdFN0cmVhbShzdHJlYW0pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcGF1c2VSZWNvcmRpbmcoKTogdm9pZCB7XG4gICAgdGhpcy5pc1BhdXNlZCA9IHRydWU7XG4gICAgdGhpcy5vblBhdXNlKCk7XG4gICAgdGhpcy52aXN1YWxpemVyPy5wYXVzZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSByZXN1bWVSZWNvcmRpbmcoKTogdm9pZCB7XG4gICAgdGhpcy5pc1BhdXNlZCA9IGZhbHNlO1xuICAgIHRoaXMub25SZXN1bWUoKTtcbiAgICB0aGlzLnZpc3VhbGl6ZXI/LnJlc3VtZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdG9wUmVjb3JkaW5nKGNhbmNlbGxlZDogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMubWVkaWFSZWNvcmRlciAmJiB0aGlzLm1lZGlhUmVjb3JkZXIuc3RhdGUgIT09ICdpbmFjdGl2ZScpIHtcbiAgICAgIHRoaXMubWVkaWFSZWNvcmRlci5zdG9wKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLnRpbWVySW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lckludGVydmFsKTtcbiAgICB9XG4gICAgdGhpcy52aXN1YWxpemVyPy5zdG9wKCk7XG4gICAgdGhpcy5vblJlY29yZGluZ0Nsb3NlKGNhbmNlbGxlZCk7XG4gIH1cblxuICBzZXRUcmFuc2NyaXB0aW9uVGV4dCh0ZXh0OiBzdHJpbmcpIHtcbiAgICB0aGlzLnRyYW5zY3JpcHRpb25UZXh0ID0gdGV4dDtcbiAgICBjb25zdCB0cmFuc2NyaXB0aW9uQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwucXVlcnlTZWxlY3RvcignLnZvaWNlMnRleHQtdHJhbnNjcmlwdGlvbicpO1xuICAgIGlmICh0cmFuc2NyaXB0aW9uQ29udGFpbmVyKSB7XG4gICAgICB0cmFuc2NyaXB0aW9uQ29udGFpbmVyLnJlbW92ZUNsYXNzKCd2b2ljZTJ0ZXh0LWhpZGRlbicpO1xuICAgICAgdGhpcy50eXBlVGV4dCh0cmFuc2NyaXB0aW9uQ29udGFpbmVyIGFzIEhUTUxFbGVtZW50LCB0ZXh0KTtcbiAgICB9XG4gIH1cblxuICBzaG93VHJhbnNjcmliaW5nKCkge1xuICAgIGlmICh0aGlzLnRyYW5zY3JpYmluZ0NvbnRhaW5lcikge1xuICAgICAgdGhpcy50cmFuc2NyaWJpbmdDb250YWluZXIucmVtb3ZlQ2xhc3MoJ3ZvaWNlMnRleHQtaGlkZGVuJyk7XG4gICAgfVxuICB9XG5cbiAgaGlkZVRyYW5zY3JpYmluZygpIHtcbiAgICBpZiAodGhpcy50cmFuc2NyaWJpbmdDb250YWluZXIpIHtcbiAgICAgIHRoaXMudHJhbnNjcmliaW5nQ29udGFpbmVyLmFkZENsYXNzKCd2b2ljZTJ0ZXh0LWhpZGRlbicpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdHlwZVRleHQoZWxlbWVudDogSFRNTEVsZW1lbnQsIHRleHQ6IHN0cmluZykge1xuICAgIGVsZW1lbnQuZW1wdHkoKTtcbiAgICBjb25zdCB0ZXh0Q29udGFpbmVyID0gZWxlbWVudC5jcmVhdGVEaXYoJ3ZvaWNlMnRleHQtdHlwaW5nLXRleHQnKTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICBzcGFuLnRleHRDb250ZW50ID0gdGV4dFtpXTtcbiAgICAgIHRleHRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTApKTtcbiAgICB9XG4gIH1cblxuICBvbkNsb3NlKCkge1xuICAgIGlmICh0aGlzLm1lZGlhUmVjb3JkZXIgJiYgdGhpcy5tZWRpYVJlY29yZGVyLnN0YXRlICE9PSAnaW5hY3RpdmUnKSB7XG4gICAgICB0aGlzLm1lZGlhUmVjb3JkZXIuc3RvcCgpO1xuICAgIH1cbiAgICBpZiAodGhpcy50aW1lckludGVydmFsKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXJJbnRlcnZhbCk7XG4gICAgfVxuICAgIHRoaXMudmlzdWFsaXplcj8uc3RvcCgpO1xuICAgIHRoaXMub25SZWNvcmRpbmdDbG9zZSh0cnVlKTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlUGF1c2VCdXR0b24oaXNQYXVzZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBjb25zdCBwYXVzZUJ1dHRvbiA9IHRoaXMucGF1c2VCdXR0b247XG4gICAgaWYgKCFwYXVzZUJ1dHRvbikgcmV0dXJuO1xuXG4gICAgLy8gXHU2RTA1XHU5NjY0XHU3M0IwXHU2NzA5XHU1MTg1XHU1QkI5XG4gICAgd2hpbGUgKHBhdXNlQnV0dG9uLmZpcnN0Q2hpbGQpIHtcbiAgICAgIHBhdXNlQnV0dG9uLnJlbW92ZUNoaWxkKHBhdXNlQnV0dG9uLmZpcnN0Q2hpbGQpO1xuICAgIH1cblxuICAgIGlmIChpc1BhdXNlZCkge1xuICAgICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcbiAgICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XG4gICAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcbiAgICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XG4gICAgICBzdmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTtcbiAgICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcbiAgICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XG4gICAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpO1xuICAgICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlY3QxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdyZWN0Jyk7XG4gICAgICByZWN0MS5zZXRBdHRyaWJ1dGUoJ3gnLCAnNicpO1xuICAgICAgcmVjdDEuc2V0QXR0cmlidXRlKCd5JywgJzQnKTtcbiAgICAgIHJlY3QxLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnNCcpO1xuICAgICAgcmVjdDEuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMTYnKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVjdDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3JlY3QnKTtcbiAgICAgIHJlY3QyLnNldEF0dHJpYnV0ZSgneCcsICcxNCcpO1xuICAgICAgcmVjdDIuc2V0QXR0cmlidXRlKCd5JywgJzQnKTtcbiAgICAgIHJlY3QyLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnNCcpO1xuICAgICAgcmVjdDIuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMTYnKTtcbiAgICAgIFxuICAgICAgc3ZnLmFwcGVuZENoaWxkKHJlY3QxKTtcbiAgICAgIHN2Zy5hcHBlbmRDaGlsZChyZWN0Mik7XG4gICAgICBwYXVzZUJ1dHRvbi5hcHBlbmRDaGlsZChzdmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xuICAgICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcbiAgICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xuICAgICAgc3ZnLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgMjQgMjQnKTtcbiAgICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xuICAgICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xuICAgICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTtcbiAgICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XG4gICAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcbiAgICAgIFxuICAgICAgY29uc3QgcG9seWdvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWdvbicpO1xuICAgICAgcG9seWdvbi5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICc1IDMgMTkgMTIgNSAyMSA1IDMnKTtcbiAgICAgIFxuICAgICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlnb24pO1xuICAgICAgcGF1c2VCdXR0b24uYXBwZW5kQ2hpbGQoc3ZnKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNob3dUcmFuc2NyaWJpbmcoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLnRyYW5zY3JpYmluZ0NvbnRhaW5lcikgcmV0dXJuO1xuICAgIFxuICAgIC8vIFx1NkUwNVx1OTY2NFx1NzNCMFx1NjcwOVx1NTE4NVx1NUJCOVxuICAgIHdoaWxlICh0aGlzLnRyYW5zY3JpYmluZ0NvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICB0aGlzLnRyYW5zY3JpYmluZ0NvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLnRyYW5zY3JpYmluZ0NvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICB9XG5cbiAgICBjb25zdCB0ZXh0U3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICB0ZXh0U3Bhbi5hZGRDbGFzcygndm9pY2UydGV4dC10cmFuc2NyaWJpbmctdGV4dCcpO1xuICAgIHRleHRTcGFuLnNldFRleHQoJ0FJIFx1OEY2Q1x1NTE5OVx1NEUyRCcpO1xuXG4gICAgY29uc3QgZG90c1NwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgZG90c1NwYW4uYWRkQ2xhc3MoJ3ZvaWNlMnRleHQtdHJhbnNjcmliaW5nLWRvdHMnKTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgY29uc3QgZG90ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgZG90LnNldFRleHQoJy4nKTtcbiAgICAgIGRvdHNTcGFuLmFwcGVuZENoaWxkKGRvdCk7XG4gICAgfVxuXG4gICAgdGhpcy50cmFuc2NyaWJpbmdDb250YWluZXIuYXBwZW5kQ2hpbGQodGV4dFNwYW4pO1xuICAgIHRoaXMudHJhbnNjcmliaW5nQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdHNTcGFuKTtcbiAgfVxufSAiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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
